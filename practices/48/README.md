# Git の基本を理解する

https://bootcamp.fjord.jp/practices/48

## 基本

https://backlog.com/ja/git-tutorial/intro/01/

* Git はバージョン管理ソフトです
* リポジトリに履歴を残す
* 変更はコミットで記録する
  * ワークツリー -> インデックスに登録 -> 変更をコミットにする -> リポジトリに登録（Push）

## インストールと設定とコミット

https://backlog.com/ja/git-tutorial/intro/05/

```
# グローバルの設定を表示する
git config --global -l
```

```
# git の長いコマンドにエイリアスを用意する
git config --global alias.co checkout
git config --global alias.ci commit
git config --global alias.sw switch
git config --global alias.st status
```

* `git init` で Gitのリポジトリを作成する
* Untracked <- 追跡対象になっていないファイル
* `git add hoge.md` みたいに追加する
  * カレントディレクトリ配下をインデックスに追加するなら `git add .`
* コミットするには `git commit`
  * `git commit -m 説明` で一気にコミットできるけど エディタで編集する方が好み
* コミットが履歴に追加されたかどうかは `git log` で確認する

## リモートリポジトリにプッシュする

https://backlog.com/ja/git-tutorial/intro/09/

* PUSH: ローカルリポジトリからリモートリポジトリにPushする
  * Pushとはアップロードのようなもの
* CLONE：すでにあるリポジトリを自分のPCに持ってくる（履歴ごと）ことを clone というよ
* PULL: リポジトリの他の人の変更などを手元に持ってくること

## リモートリポジトリを設定する

* リモートリポジトリに名前をつけられる。（一般的に `origin` を使う）
* `$ git remote add <name> <url>` で設定ファイルに登録できる。
* PUSHする
  * `git push <repository> <refspec>`

## 変更履歴のマージ

https://backlog.com/ja/git-tutorial/intro/17/

* リモートリポジトリに他の人が変更をPUSHしている場合、自分の変更のPUSHが拒否される
* マージ作業をして、他の人の変更を取り込まないといけない
* マージは自動で完了することもあるけど、同じファイルの同じ場所に変更がある場合は競合が発生する
 * 競合は人間が目で確認して手で直していく

## ブランチ

* 並行して行われる作業のために **ブランチ** という機能がある。
* mainブランチから作業用のブランチを作り、作業が終わったらブランチの変更を main に取り込むことで、他の人の作業に影響を与えないようにできる

## ブランチ運用

* 統合ブランチ：リリース版が作れるブランチ。
* トピックブランチ：機能追加やバグ修正など、特定の作業をするために作るブランチ。安定した統合ブランチから分岐して、最終的には統合ブランチに取り込む

## ブランチの切り替え

* `checkout` を使ってブランチを切り替えることができる（最近は `switch` かな）
* ワークツリーに移動先のブランチの内容が展開される
* `HEAD` : 現在いるブランチの先頭を `HEAD` という

## ブランチの切り替えができない時は stash する

* まだコミットしていない変更がある場合（git status して変更がでる時）は、ブランチの移動をしない方がいい
  * 移動先のブランチと変更が競合してしまい、競合の解消に手間取るので
  * そういう場合は `stash` を使って、コミットしていない変更を退避させる
  * 個人的には `stash` に入れたものを `stash pop` で取り出すことはあまり多くない（stash 管理むずかしい）
  * 業務の中で今取り組んでるブランチを離れるのは、割り込みでバグ対応をデプロイしたいとか、そういうケースが多いので、僕は一旦 `git commit -mWIP` で全部コミットしてからブランチを離れます

## ブランチの統合

https://backlog.com/ja/git-tutorial/stepup/04/

* `merge` と `rebase`
  * 難しい。自分はトピックブランチで `rebase` して 最終的に main にマージしている

## ブランチ運用の例

https://backlog.com/ja/git-tutorial/stepup/05/

* A successful Git branching model という運用例が紹介されている

## プルリクエストとは？

開発者のローカルリポジトリでの変更を他の開発者に通知する機能

* ソースコードの変更箇所をわかりやすく表示
* ソースコードに関するコミュニケーションの場を提供

## プルリクエストのメリット

レビュー・マージ作業をタスク化して管理し、やりとりを記録できる

* やりとりを経て、最終的にマージされるソースコードの品質を高くできます
* 問題が起こった時に過去のやりとりを見て再度議論できます

レビューを促進できる

* ソースコードの意図や補足事項をコメントとして伝えることができます。これらによって、レビュー担当者の負担を減らせます


